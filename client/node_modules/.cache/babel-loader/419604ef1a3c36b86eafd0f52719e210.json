{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Logger = void 0;\n\nconst path = require(\"path\");\n\nconst timestamp = () => new Date().toISOString();\n\nlet timer;\n\nconst wait = ms => new Promise(resolve => {\n  if (timer) timer.unref();\n  timer = setTimeout(() => resolve(null), ms);\n});\n\nfunction chomp(s) {\n  if (s.endsWith('\\n')) return s.replace(/\\n$/, '');\n  return s;\n}\n\nclass Logger {\n  // eslint-disable-next-line no-useless-constructor\n  constructor(file) {\n    this.file = file;\n    this.flushing = Promise.resolve();\n    this.buffer = [];\n  }\n\n  log(msg) {\n    const stripAnsi = require('strip-ansi');\n\n    msg = stripAnsi(chomp(msg));\n    const lines = msg.split('\\n').map(l => `${timestamp()} ${l}`.trimEnd());\n    this.buffer.push(...lines); // tslint:disable-next-line no-console\n\n    this.flush(50).catch(console.error);\n  }\n\n  async flush(waitForMs = 0) {\n    await wait(waitForMs);\n    this.flushing = this.flushing.then(async () => {\n      if (this.buffer.length === 0) return;\n      const mylines = this.buffer;\n      this.buffer = [];\n\n      const fs = require('fs-extra');\n\n      await fs.mkdirp(path.dirname(this.file));\n      await fs.appendFile(this.file, mylines.join('\\n') + '\\n');\n    });\n    await this.flushing;\n  }\n\n}\n\nexports.Logger = Logger;","map":{"version":3,"names":["Object","defineProperty","exports","value","Logger","path","require","timestamp","Date","toISOString","timer","wait","ms","Promise","resolve","unref","setTimeout","chomp","s","endsWith","replace","constructor","file","flushing","buffer","log","msg","stripAnsi","lines","split","map","l","trimEnd","push","flush","catch","console","error","waitForMs","then","length","mylines","fs","mkdirp","dirname","appendFile","join"],"sources":["/Users/Ellie/Desktop/projects/book-search-engine/client/node_modules/@oclif/core/lib/errors/logger.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Logger = void 0;\nconst path = require(\"path\");\nconst timestamp = () => new Date().toISOString();\nlet timer;\nconst wait = (ms) => new Promise(resolve => {\n    if (timer)\n        timer.unref();\n    timer = setTimeout(() => resolve(null), ms);\n});\nfunction chomp(s) {\n    if (s.endsWith('\\n'))\n        return s.replace(/\\n$/, '');\n    return s;\n}\nclass Logger {\n    // eslint-disable-next-line no-useless-constructor\n    constructor(file) {\n        this.file = file;\n        this.flushing = Promise.resolve();\n        this.buffer = [];\n    }\n    log(msg) {\n        const stripAnsi = require('strip-ansi');\n        msg = stripAnsi(chomp(msg));\n        const lines = msg.split('\\n').map(l => `${timestamp()} ${l}`.trimEnd());\n        this.buffer.push(...lines);\n        // tslint:disable-next-line no-console\n        this.flush(50).catch(console.error);\n    }\n    async flush(waitForMs = 0) {\n        await wait(waitForMs);\n        this.flushing = this.flushing.then(async () => {\n            if (this.buffer.length === 0)\n                return;\n            const mylines = this.buffer;\n            this.buffer = [];\n            const fs = require('fs-extra');\n            await fs.mkdirp(path.dirname(this.file));\n            await fs.appendFile(this.file, mylines.join('\\n') + '\\n');\n        });\n        await this.flushing;\n    }\n}\nexports.Logger = Logger;\n"],"mappings":"AAAA;;AACAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;EAAEC,KAAK,EAAE;AAAT,CAA7C;AACAD,OAAO,CAACE,MAAR,GAAiB,KAAK,CAAtB;;AACA,MAAMC,IAAI,GAAGC,OAAO,CAAC,MAAD,CAApB;;AACA,MAAMC,SAAS,GAAG,MAAM,IAAIC,IAAJ,GAAWC,WAAX,EAAxB;;AACA,IAAIC,KAAJ;;AACA,MAAMC,IAAI,GAAIC,EAAD,IAAQ,IAAIC,OAAJ,CAAYC,OAAO,IAAI;EACxC,IAAIJ,KAAJ,EACIA,KAAK,CAACK,KAAN;EACJL,KAAK,GAAGM,UAAU,CAAC,MAAMF,OAAO,CAAC,IAAD,CAAd,EAAsBF,EAAtB,CAAlB;AACH,CAJoB,CAArB;;AAKA,SAASK,KAAT,CAAeC,CAAf,EAAkB;EACd,IAAIA,CAAC,CAACC,QAAF,CAAW,IAAX,CAAJ,EACI,OAAOD,CAAC,CAACE,OAAF,CAAU,KAAV,EAAiB,EAAjB,CAAP;EACJ,OAAOF,CAAP;AACH;;AACD,MAAMd,MAAN,CAAa;EACT;EACAiB,WAAW,CAACC,IAAD,EAAO;IACd,KAAKA,IAAL,GAAYA,IAAZ;IACA,KAAKC,QAAL,GAAgBV,OAAO,CAACC,OAAR,EAAhB;IACA,KAAKU,MAAL,GAAc,EAAd;EACH;;EACDC,GAAG,CAACC,GAAD,EAAM;IACL,MAAMC,SAAS,GAAGrB,OAAO,CAAC,YAAD,CAAzB;;IACAoB,GAAG,GAAGC,SAAS,CAACV,KAAK,CAACS,GAAD,CAAN,CAAf;IACA,MAAME,KAAK,GAAGF,GAAG,CAACG,KAAJ,CAAU,IAAV,EAAgBC,GAAhB,CAAoBC,CAAC,IAAK,GAAExB,SAAS,EAAG,IAAGwB,CAAE,EAApB,CAAsBC,OAAtB,EAAzB,CAAd;IACA,KAAKR,MAAL,CAAYS,IAAZ,CAAiB,GAAGL,KAApB,EAJK,CAKL;;IACA,KAAKM,KAAL,CAAW,EAAX,EAAeC,KAAf,CAAqBC,OAAO,CAACC,KAA7B;EACH;;EACU,MAALH,KAAK,CAACI,SAAS,GAAG,CAAb,EAAgB;IACvB,MAAM3B,IAAI,CAAC2B,SAAD,CAAV;IACA,KAAKf,QAAL,GAAgB,KAAKA,QAAL,CAAcgB,IAAd,CAAmB,YAAY;MAC3C,IAAI,KAAKf,MAAL,CAAYgB,MAAZ,KAAuB,CAA3B,EACI;MACJ,MAAMC,OAAO,GAAG,KAAKjB,MAArB;MACA,KAAKA,MAAL,GAAc,EAAd;;MACA,MAAMkB,EAAE,GAAGpC,OAAO,CAAC,UAAD,CAAlB;;MACA,MAAMoC,EAAE,CAACC,MAAH,CAAUtC,IAAI,CAACuC,OAAL,CAAa,KAAKtB,IAAlB,CAAV,CAAN;MACA,MAAMoB,EAAE,CAACG,UAAH,CAAc,KAAKvB,IAAnB,EAAyBmB,OAAO,CAACK,IAAR,CAAa,IAAb,IAAqB,IAA9C,CAAN;IACH,CARe,CAAhB;IASA,MAAM,KAAKvB,QAAX;EACH;;AA3BQ;;AA6BbrB,OAAO,CAACE,MAAR,GAAiBA,MAAjB"},"metadata":{},"sourceType":"script"}