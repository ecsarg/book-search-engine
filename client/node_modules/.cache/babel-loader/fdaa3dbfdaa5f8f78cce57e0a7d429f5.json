{"ast":null,"code":"'use strict';\n\nconst Observable = require('any-observable');\n\nfunction or(option, alternate, required) {\n  const result = option === false ? false : option || alternate;\n\n  if (required && !result || result && typeof result !== 'string') {\n    throw new TypeError(alternate + 'Event must be a string.');\n  }\n\n  return result;\n}\n\nmodule.exports = (stream, opts) => {\n  opts = opts || {};\n  let complete = false;\n  let dataListeners = [];\n  const awaited = opts.await;\n  const dataEvent = or(opts.dataEvent, 'data', true);\n  const errorEvent = or(opts.errorEvent, 'error');\n  const endEvent = or(opts.endEvent, 'end');\n\n  function cleanup() {\n    complete = true;\n    dataListeners.forEach(listener => {\n      stream.removeListener(dataEvent, listener);\n    });\n    dataListeners = null;\n  }\n\n  const completion = new Promise((resolve, reject) => {\n    function onEnd(result) {\n      if (awaited) {\n        awaited.then(resolve);\n      } else {\n        resolve(result);\n      }\n    }\n\n    if (endEvent) {\n      stream.once(endEvent, onEnd);\n    } else if (awaited) {\n      onEnd();\n    }\n\n    if (errorEvent) {\n      stream.once(errorEvent, reject);\n    }\n\n    if (awaited) {\n      awaited.catch(reject);\n    }\n  }).catch(err => {\n    cleanup();\n    throw err;\n  }).then(result => {\n    cleanup();\n    return result;\n  });\n  return new Observable(observer => {\n    completion.then(observer.complete.bind(observer)).catch(observer.error.bind(observer));\n\n    if (complete) {\n      return null;\n    }\n\n    const onData = data => {\n      observer.next(data);\n    };\n\n    stream.on(dataEvent, onData);\n    dataListeners.push(onData);\n    return () => {\n      stream.removeListener(dataEvent, onData);\n\n      if (complete) {\n        return;\n      }\n\n      const idx = dataListeners.indexOf(onData);\n\n      if (idx !== -1) {\n        dataListeners.splice(idx, 1);\n      }\n    };\n  });\n};","map":{"version":3,"names":["Observable","require","or","option","alternate","required","result","TypeError","module","exports","stream","opts","complete","dataListeners","awaited","await","dataEvent","errorEvent","endEvent","cleanup","forEach","listener","removeListener","completion","Promise","resolve","reject","onEnd","then","once","catch","err","observer","bind","error","onData","data","next","on","push","idx","indexOf","splice"],"sources":["/Users/Ellie/Desktop/projects/book-search-engine/client/node_modules/@samverschueren/stream-to-observable/index.js"],"sourcesContent":["'use strict';\nconst Observable = require('any-observable');\n\nfunction or(option, alternate, required) {\n\tconst result = option === false ? false : option || alternate;\n\n\tif ((required && !result) || (result && typeof result !== 'string')) {\n\t\tthrow new TypeError(alternate + 'Event must be a string.');\n\t}\n\n\treturn result;\n}\n\nmodule.exports = (stream, opts) => {\n\topts = opts || {};\n\n\tlet complete = false;\n\tlet dataListeners = [];\n\tconst awaited = opts.await;\n\tconst dataEvent = or(opts.dataEvent, 'data', true);\n\tconst errorEvent = or(opts.errorEvent, 'error');\n\tconst endEvent = or(opts.endEvent, 'end');\n\n\tfunction cleanup() {\n\t\tcomplete = true;\n\t\tdataListeners.forEach(listener => {\n\t\t\tstream.removeListener(dataEvent, listener);\n\t\t});\n\t\tdataListeners = null;\n\t}\n\n\tconst completion = new Promise((resolve, reject) => {\n\t\tfunction onEnd(result) {\n\t\t\tif (awaited) {\n\t\t\t\tawaited.then(resolve);\n\t\t\t} else {\n\t\t\t\tresolve(result);\n\t\t\t}\n\t\t}\n\n\t\tif (endEvent) {\n\t\t\tstream.once(endEvent, onEnd);\n\t\t} else if (awaited) {\n\t\t\tonEnd();\n\t\t}\n\n\t\tif (errorEvent) {\n\t\t\tstream.once(errorEvent, reject);\n\t\t}\n\n\t\tif (awaited) {\n\t\t\tawaited.catch(reject);\n\t\t}\n\t}).catch(err => {\n\t\tcleanup();\n\t\tthrow err;\n\t}).then(result => {\n\t\tcleanup();\n\t\treturn result;\n\t});\n\n\treturn new Observable(observer => {\n\t\tcompletion\n\t\t\t.then(observer.complete.bind(observer))\n\t\t\t.catch(observer.error.bind(observer));\n\n\t\tif (complete) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst onData = data => {\n\t\t\tobserver.next(data);\n\t\t};\n\n\t\tstream.on(dataEvent, onData);\n\t\tdataListeners.push(onData);\n\n\t\treturn () => {\n\t\t\tstream.removeListener(dataEvent, onData);\n\n\t\t\tif (complete) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst idx = dataListeners.indexOf(onData);\n\n\t\t\tif (idx !== -1) {\n\t\t\t\tdataListeners.splice(idx, 1);\n\t\t\t}\n\t\t};\n\t});\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}