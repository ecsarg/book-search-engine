{"ast":null,"code":"// Copied from several files in node's source code.\n// https://github.com/nodejs/node/blob/2d5d77306f6dff9110c1f77fefab25f973415770/lib/internal/modules/cjs/loader.js\n// Each function and variable below must have a comment linking to the source in node's github repo.\nconst path = require('path');\n\nconst packageJsonReader = require('./node-package-json-reader');\n\nconst {\n  JSONParse\n} = require('./node-primordials');\n\nmodule.exports.assertScriptCanLoadAsCJSImpl = assertScriptCanLoadAsCJSImpl; // copied from Module._extensions['.js']\n// https://github.com/nodejs/node/blob/v15.3.0/lib/internal/modules/cjs/loader.js#L1113-L1120\n\nfunction assertScriptCanLoadAsCJSImpl(filename) {\n  const pkg = readPackageScope(filename); // Function require shouldn't be used in ES modules.\n\n  if (pkg && pkg.data && pkg.data.type === 'module') {\n    const parentPath = module.parent && module.parent.filename;\n    const packageJsonPath = path.resolve(pkg.path, 'package.json');\n    throw createErrRequireEsm(filename, parentPath, packageJsonPath);\n  }\n} // Copied from https://github.com/nodejs/node/blob/2d5d77306f6dff9110c1f77fefab25f973415770/lib/internal/modules/cjs/loader.js#L285-L301\n\n\nfunction readPackageScope(checkPath) {\n  const rootSeparatorIndex = checkPath.indexOf(path.sep);\n  let separatorIndex;\n\n  while ((separatorIndex = checkPath.lastIndexOf(path.sep)) > rootSeparatorIndex) {\n    checkPath = checkPath.slice(0, separatorIndex);\n    if (checkPath.endsWith(path.sep + 'node_modules')) return false;\n    const pjson = readPackage(checkPath);\n    if (pjson) return {\n      path: checkPath,\n      data: pjson\n    };\n  }\n\n  return false;\n} // Copied from https://github.com/nodejs/node/blob/2d5d77306f6dff9110c1f77fefab25f973415770/lib/internal/modules/cjs/loader.js#L249\n\n\nconst packageJsonCache = new Map(); // Copied from https://github.com/nodejs/node/blob/v15.3.0/lib/internal/modules/cjs/loader.js#L275-L304\n\nfunction readPackage(requestPath) {\n  const jsonPath = path.resolve(requestPath, 'package.json');\n  const existing = packageJsonCache.get(jsonPath);\n  if (existing !== undefined) return existing;\n  const result = packageJsonReader.read(jsonPath);\n  const json = result.containsKeys === false ? '{}' : result.string;\n\n  if (json === undefined) {\n    packageJsonCache.set(jsonPath, false);\n    return false;\n  }\n\n  try {\n    const parsed = JSONParse(json);\n    const filtered = {\n      name: parsed.name,\n      main: parsed.main,\n      exports: parsed.exports,\n      imports: parsed.imports,\n      type: parsed.type\n    };\n    packageJsonCache.set(jsonPath, filtered);\n    return filtered;\n  } catch (e) {\n    e.path = jsonPath;\n    e.message = 'Error parsing ' + jsonPath + ': ' + e.message;\n    throw e;\n  }\n} // Native ERR_REQUIRE_ESM Error is declared here:\n//   https://github.com/nodejs/node/blob/2d5d77306f6dff9110c1f77fefab25f973415770/lib/internal/errors.js#L1294-L1313\n// Error class factory is implemented here:\n//   function E: https://github.com/nodejs/node/blob/2d5d77306f6dff9110c1f77fefab25f973415770/lib/internal/errors.js#L323-L341\n//   function makeNodeErrorWithCode: https://github.com/nodejs/node/blob/2d5d77306f6dff9110c1f77fefab25f973415770/lib/internal/errors.js#L251-L278\n// The code below should create an error that matches the native error as closely as possible.\n// Third-party libraries which attempt to catch the native ERR_REQUIRE_ESM should recognize our imitation error.\n\n\nfunction createErrRequireEsm(filename, parentPath, packageJsonPath) {\n  const code = 'ERR_REQUIRE_ESM';\n  const err = new Error(getMessage(filename, parentPath, packageJsonPath)); // Set `name` to be used in stack trace, generate stack trace with that name baked in, then re-declare the `name` field.\n  // This trick is copied from node's source.\n\n  err.name = `Error [${code}]`;\n  err.stack;\n  Object.defineProperty(err, 'name', {\n    value: 'Error',\n    enumerable: false,\n    writable: true,\n    configurable: true\n  });\n  err.code = code;\n  return err; // Copy-pasted from https://github.com/nodejs/node/blob/b533fb3508009e5f567cc776daba8fbf665386a6/lib/internal/errors.js#L1293-L1311\n  // so that our error message is identical to the native message.\n\n  function getMessage(filename, parentPath = null, packageJsonPath = null) {\n    const ext = path.extname(filename);\n    let msg = `Must use import to load ES Module: ${filename}`;\n\n    if (parentPath && packageJsonPath) {\n      const path = require('path');\n\n      const basename = path.basename(filename) === path.basename(parentPath) ? filename : path.basename(filename);\n      msg += '\\nrequire() of ES modules is not supported.\\nrequire() of ' + `${filename} ${parentPath ? `from ${parentPath} ` : ''}` + `is an ES module file as it is a ${ext} file whose nearest parent ` + `package.json contains \"type\": \"module\" which defines all ${ext} ` + 'files in that package scope as ES modules.\\nInstead ' + 'change the requiring code to use ' + 'import(), or remove \"type\": \"module\" from ' + `${packageJsonPath}.\\n`;\n      return msg;\n    }\n\n    return msg;\n  }\n}","map":{"version":3,"names":["path","require","packageJsonReader","JSONParse","module","exports","assertScriptCanLoadAsCJSImpl","filename","pkg","readPackageScope","data","type","parentPath","parent","packageJsonPath","resolve","createErrRequireEsm","checkPath","rootSeparatorIndex","indexOf","sep","separatorIndex","lastIndexOf","slice","endsWith","pjson","readPackage","packageJsonCache","Map","requestPath","jsonPath","existing","get","undefined","result","read","json","containsKeys","string","set","parsed","filtered","name","main","imports","e","message","code","err","Error","getMessage","stack","Object","defineProperty","value","enumerable","writable","configurable","ext","extname","msg","basename"],"sources":["/Users/Ellie/Desktop/projects/book-search-engine/client/node_modules/ts-node/dist-raw/node-cjs-loader-utils.js"],"sourcesContent":["// Copied from several files in node's source code.\n// https://github.com/nodejs/node/blob/2d5d77306f6dff9110c1f77fefab25f973415770/lib/internal/modules/cjs/loader.js\n// Each function and variable below must have a comment linking to the source in node's github repo.\n\nconst path = require('path');\nconst packageJsonReader = require('./node-package-json-reader');\nconst {JSONParse} = require('./node-primordials');\n\nmodule.exports.assertScriptCanLoadAsCJSImpl = assertScriptCanLoadAsCJSImpl;\n\n// copied from Module._extensions['.js']\n// https://github.com/nodejs/node/blob/v15.3.0/lib/internal/modules/cjs/loader.js#L1113-L1120\nfunction assertScriptCanLoadAsCJSImpl(filename) {\n  const pkg = readPackageScope(filename);\n  // Function require shouldn't be used in ES modules.\n  if (pkg && pkg.data && pkg.data.type === 'module') {\n    const parentPath = module.parent && module.parent.filename;\n    const packageJsonPath = path.resolve(pkg.path, 'package.json');\n    throw createErrRequireEsm(filename, parentPath, packageJsonPath);\n  }\n}\n\n// Copied from https://github.com/nodejs/node/blob/2d5d77306f6dff9110c1f77fefab25f973415770/lib/internal/modules/cjs/loader.js#L285-L301\nfunction readPackageScope(checkPath) {\n  const rootSeparatorIndex = checkPath.indexOf(path.sep);\n  let separatorIndex;\n  while (\n    (separatorIndex = checkPath.lastIndexOf(path.sep)) > rootSeparatorIndex\n  ) {\n    checkPath = checkPath.slice(0, separatorIndex);\n    if (checkPath.endsWith(path.sep + 'node_modules'))\n      return false;\n    const pjson = readPackage(checkPath);\n    if (pjson) return {\n      path: checkPath,\n      data: pjson\n    };\n  }\n  return false;\n}\n\n// Copied from https://github.com/nodejs/node/blob/2d5d77306f6dff9110c1f77fefab25f973415770/lib/internal/modules/cjs/loader.js#L249\nconst packageJsonCache = new Map();\n\n// Copied from https://github.com/nodejs/node/blob/v15.3.0/lib/internal/modules/cjs/loader.js#L275-L304\nfunction readPackage(requestPath) {\n  const jsonPath = path.resolve(requestPath, 'package.json');\n\n  const existing = packageJsonCache.get(jsonPath);\n  if (existing !== undefined) return existing;\n\n  const result = packageJsonReader.read(jsonPath);\n  const json = result.containsKeys === false ? '{}' : result.string;\n  if (json === undefined) {\n    packageJsonCache.set(jsonPath, false);\n    return false;\n  }\n\n  try {\n    const parsed = JSONParse(json);\n    const filtered = {\n      name: parsed.name,\n      main: parsed.main,\n      exports: parsed.exports,\n      imports: parsed.imports,\n      type: parsed.type\n    };\n    packageJsonCache.set(jsonPath, filtered);\n    return filtered;\n  } catch (e) {\n    e.path = jsonPath;\n    e.message = 'Error parsing ' + jsonPath + ': ' + e.message;\n    throw e;\n  }\n}\n\n// Native ERR_REQUIRE_ESM Error is declared here:\n//   https://github.com/nodejs/node/blob/2d5d77306f6dff9110c1f77fefab25f973415770/lib/internal/errors.js#L1294-L1313\n// Error class factory is implemented here:\n//   function E: https://github.com/nodejs/node/blob/2d5d77306f6dff9110c1f77fefab25f973415770/lib/internal/errors.js#L323-L341\n//   function makeNodeErrorWithCode: https://github.com/nodejs/node/blob/2d5d77306f6dff9110c1f77fefab25f973415770/lib/internal/errors.js#L251-L278\n// The code below should create an error that matches the native error as closely as possible.\n// Third-party libraries which attempt to catch the native ERR_REQUIRE_ESM should recognize our imitation error.\nfunction createErrRequireEsm(filename, parentPath, packageJsonPath) {\n  const code = 'ERR_REQUIRE_ESM'\n  const err = new Error(getMessage(filename, parentPath, packageJsonPath))\n  // Set `name` to be used in stack trace, generate stack trace with that name baked in, then re-declare the `name` field.\n  // This trick is copied from node's source.\n  err.name = `Error [${ code }]`\n  err.stack\n  Object.defineProperty(err, 'name', {\n    value: 'Error',\n    enumerable: false,\n    writable: true,\n    configurable: true\n  })\n  err.code = code\n  return err\n\n  // Copy-pasted from https://github.com/nodejs/node/blob/b533fb3508009e5f567cc776daba8fbf665386a6/lib/internal/errors.js#L1293-L1311\n  // so that our error message is identical to the native message.\n  function getMessage(filename, parentPath = null, packageJsonPath = null) {\n    const ext = path.extname(filename)\n    let msg = `Must use import to load ES Module: ${filename}`;\n    if (parentPath && packageJsonPath) {\n      const path = require('path');\n      const basename = path.basename(filename) === path.basename(parentPath) ?\n        filename : path.basename(filename);\n      msg +=\n        '\\nrequire() of ES modules is not supported.\\nrequire() of ' +\n        `${filename} ${parentPath ? `from ${parentPath} ` : ''}` +\n        `is an ES module file as it is a ${ext} file whose nearest parent ` +\n        `package.json contains \"type\": \"module\" which defines all ${ext} ` +\n        'files in that package scope as ES modules.\\nInstead ' +\n        'change the requiring code to use ' +\n        'import(), or remove \"type\": \"module\" from ' +\n        `${packageJsonPath}.\\n`;\n      return msg;\n    }\n    return msg;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}