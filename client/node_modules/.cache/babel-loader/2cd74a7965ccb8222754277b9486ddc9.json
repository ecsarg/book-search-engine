{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.executableDirectivesInAllServices = void 0;\n\nconst graphql_1 = require(\"graphql\");\n\nconst utils_1 = require(\"../../utils\");\n\nconst executableDirectivesInAllServices = ({\n  schema,\n  serviceList\n}) => {\n  const errors = [];\n  const customExecutableDirectives = schema.getDirectives().filter(x => !utils_1.isApolloTypeSystemDirective(x) && !graphql_1.isSpecifiedDirective(x));\n  customExecutableDirectives.forEach(directive => {\n    var _a;\n\n    const directiveFederationMetadata = utils_1.getFederationMetadata(directive);\n    if (!directiveFederationMetadata) return;\n    const allServiceNames = serviceList.map(({\n      name\n    }) => name);\n    const serviceNamesWithDirective = Object.keys(directiveFederationMetadata.directiveDefinitions);\n    const serviceNamesWithoutDirective = allServiceNames.reduce((without, serviceName) => {\n      if (!serviceNamesWithDirective.includes(serviceName)) {\n        without.push(serviceName);\n      }\n\n      return without;\n    }, []);\n\n    if (serviceNamesWithoutDirective.length > 0) {\n      errors.push(utils_1.errorWithCode('EXECUTABLE_DIRECTIVES_IN_ALL_SERVICES', utils_1.logDirective(directive.name) + `Custom directives must be implemented in every service. The following services do not implement the @${directive.name} directive: ${serviceNamesWithoutDirective.join(', ')}.`, (_a = directive.astNode) !== null && _a !== void 0 ? _a : undefined));\n    }\n  });\n  return errors;\n};\n\nexports.executableDirectivesInAllServices = executableDirectivesInAllServices;","map":{"version":3,"sources":["../../../../src/composition/validate/postComposition/executableDirectivesInAllServices.ts"],"names":[],"mappings":";;;;;;;AAAA,MAAA,SAAA,GAAA,OAAA,CAAA,SAAA,CAAA;;AACA,MAAA,OAAA,GAAA,OAAA,CAAA,aAAA,CAAA;;AAaO,MAAM,iCAAiC,GAA6B,CAAC;EAC1E,MAD0E;EAE1E;AAF0E,CAAD,KAGtE;EACH,MAAM,MAAM,GAAmB,EAA/B;EAEA,MAAM,0BAA0B,GAAG,MAAM,CACtC,aADgC,GAEhC,MAFgC,CAEzB,CAAC,IAAI,CAAC,OAAA,CAAA,2BAAA,CAA4B,CAA5B,CAAD,IAAmC,CAAC,SAAA,CAAA,oBAAA,CAAqB,CAArB,CAFhB,CAAnC;EAIA,0BAA0B,CAAC,OAA3B,CAAmC,SAAS,IAAG;;;IAC7C,MAAM,2BAA2B,GAAG,OAAA,CAAA,qBAAA,CAAsB,SAAtB,CAApC;IAEA,IAAI,CAAC,2BAAL,EAAkC;IAElC,MAAM,eAAe,GAAG,WAAW,CAAC,GAAZ,CAAgB,CAAC;MAAE;IAAF,CAAD,KAAc,IAA9B,CAAxB;IACA,MAAM,yBAAyB,GAAG,MAAM,CAAC,IAAP,CAChC,2BAA2B,CAAC,oBADI,CAAlC;IAIA,MAAM,4BAA4B,GAAG,eAAe,CAAC,MAAhB,CACnC,CAAC,OAAD,EAAU,WAAV,KAAyB;MACvB,IAAI,CAAC,yBAAyB,CAAC,QAA1B,CAAmC,WAAnC,CAAL,EAAsD;QACpD,OAAO,CAAC,IAAR,CAAa,WAAb;MACD;;MACD,OAAO,OAAP;IACD,CANkC,EAOnC,EAPmC,CAArC;;IAUA,IAAI,4BAA4B,CAAC,MAA7B,GAAsC,CAA1C,EAA6C;MAC3C,MAAM,CAAC,IAAP,CACE,OAAA,CAAA,aAAA,CACE,uCADF,EAEE,OAAA,CAAA,YAAA,CAAa,SAAS,CAAC,IAAvB,IACE,wGACE,SAAS,CAAC,IACZ,eAAe,4BAA4B,CAAC,IAA7B,CAAkC,IAAlC,CAAuC,GAL1D,EAQE,CAAA,EAAA,GAAA,SAAS,CAAC,OAAV,MAAiB,IAAjB,IAAiB,EAAA,KAAA,KAAA,CAAjB,GAAiB,EAAjB,GAAqB,SARvB,CADF;IAYD;EACF,CAlCD;EAoCA,OAAO,MAAP;AACD,CA/CM;;AAAM,OAAA,CAAA,iCAAA,GAAiC,iCAAjC","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.executableDirectivesInAllServices = void 0;\nconst graphql_1 = require(\"graphql\");\nconst utils_1 = require(\"../../utils\");\nconst executableDirectivesInAllServices = ({ schema, serviceList, }) => {\n    const errors = [];\n    const customExecutableDirectives = schema\n        .getDirectives()\n        .filter(x => !utils_1.isApolloTypeSystemDirective(x) && !graphql_1.isSpecifiedDirective(x));\n    customExecutableDirectives.forEach(directive => {\n        var _a;\n        const directiveFederationMetadata = utils_1.getFederationMetadata(directive);\n        if (!directiveFederationMetadata)\n            return;\n        const allServiceNames = serviceList.map(({ name }) => name);\n        const serviceNamesWithDirective = Object.keys(directiveFederationMetadata.directiveDefinitions);\n        const serviceNamesWithoutDirective = allServiceNames.reduce((without, serviceName) => {\n            if (!serviceNamesWithDirective.includes(serviceName)) {\n                without.push(serviceName);\n            }\n            return without;\n        }, []);\n        if (serviceNamesWithoutDirective.length > 0) {\n            errors.push(utils_1.errorWithCode('EXECUTABLE_DIRECTIVES_IN_ALL_SERVICES', utils_1.logDirective(directive.name) +\n                `Custom directives must be implemented in every service. The following services do not implement the @${directive.name} directive: ${serviceNamesWithoutDirective.join(', ')}.`, (_a = directive.astNode) !== null && _a !== void 0 ? _a : undefined));\n        }\n    });\n    return errors;\n};\nexports.executableDirectivesInAllServices = executableDirectivesInAllServices;\n//# sourceMappingURL=executableDirectivesInAllServices.js.map"]},"metadata":{},"sourceType":"script"}