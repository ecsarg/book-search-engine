{"ast":null,"code":"\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CancellationTokenSource = exports.CancellationToken = void 0;\n\nconst ral_1 = require(\"./ral\");\n\nconst Is = require(\"./is\");\n\nconst events_1 = require(\"./events\");\n\nvar CancellationToken;\n\n(function (CancellationToken) {\n  CancellationToken.None = Object.freeze({\n    isCancellationRequested: false,\n    onCancellationRequested: events_1.Event.None\n  });\n  CancellationToken.Cancelled = Object.freeze({\n    isCancellationRequested: true,\n    onCancellationRequested: events_1.Event.None\n  });\n\n  function is(value) {\n    const candidate = value;\n    return candidate && (candidate === CancellationToken.None || candidate === CancellationToken.Cancelled || Is.boolean(candidate.isCancellationRequested) && !!candidate.onCancellationRequested);\n  }\n\n  CancellationToken.is = is;\n})(CancellationToken = exports.CancellationToken || (exports.CancellationToken = {}));\n\nconst shortcutEvent = Object.freeze(function (callback, context) {\n  const handle = ral_1.default().timer.setTimeout(callback.bind(context), 0);\n  return {\n    dispose() {\n      ral_1.default().timer.clearTimeout(handle);\n    }\n\n  };\n});\n\nclass MutableToken {\n  constructor() {\n    this._isCancelled = false;\n  }\n\n  cancel() {\n    if (!this._isCancelled) {\n      this._isCancelled = true;\n\n      if (this._emitter) {\n        this._emitter.fire(undefined);\n\n        this.dispose();\n      }\n    }\n  }\n\n  get isCancellationRequested() {\n    return this._isCancelled;\n  }\n\n  get onCancellationRequested() {\n    if (this._isCancelled) {\n      return shortcutEvent;\n    }\n\n    if (!this._emitter) {\n      this._emitter = new events_1.Emitter();\n    }\n\n    return this._emitter.event;\n  }\n\n  dispose() {\n    if (this._emitter) {\n      this._emitter.dispose();\n\n      this._emitter = undefined;\n    }\n  }\n\n}\n\nclass CancellationTokenSource {\n  get token() {\n    if (!this._token) {\n      // be lazy and create the token only when\n      // actually needed\n      this._token = new MutableToken();\n    }\n\n    return this._token;\n  }\n\n  cancel() {\n    if (!this._token) {\n      // save an object by returning the default\n      // cancelled token when cancellation happens\n      // before someone asks for the token\n      this._token = CancellationToken.Cancelled;\n    } else {\n      this._token.cancel();\n    }\n  }\n\n  dispose() {\n    if (!this._token) {\n      // ensure to initialize with an empty token if we had none\n      this._token = CancellationToken.None;\n    } else if (this._token instanceof MutableToken) {\n      // actually dispose\n      this._token.dispose();\n    }\n  }\n\n}\n\nexports.CancellationTokenSource = CancellationTokenSource;","map":{"version":3,"names":["Object","defineProperty","exports","value","CancellationTokenSource","CancellationToken","ral_1","require","Is","events_1","None","freeze","isCancellationRequested","onCancellationRequested","Event","Cancelled","is","candidate","boolean","shortcutEvent","callback","context","handle","default","timer","setTimeout","bind","dispose","clearTimeout","MutableToken","constructor","_isCancelled","cancel","_emitter","fire","undefined","Emitter","event","token","_token"],"sources":["/Users/Ellie/Desktop/projects/book-search-engine/client/node_modules/vscode-jsonrpc/lib/common/cancellation.js"],"sourcesContent":["\"use strict\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CancellationTokenSource = exports.CancellationToken = void 0;\nconst ral_1 = require(\"./ral\");\nconst Is = require(\"./is\");\nconst events_1 = require(\"./events\");\nvar CancellationToken;\n(function (CancellationToken) {\n    CancellationToken.None = Object.freeze({\n        isCancellationRequested: false,\n        onCancellationRequested: events_1.Event.None\n    });\n    CancellationToken.Cancelled = Object.freeze({\n        isCancellationRequested: true,\n        onCancellationRequested: events_1.Event.None\n    });\n    function is(value) {\n        const candidate = value;\n        return candidate && (candidate === CancellationToken.None\n            || candidate === CancellationToken.Cancelled\n            || (Is.boolean(candidate.isCancellationRequested) && !!candidate.onCancellationRequested));\n    }\n    CancellationToken.is = is;\n})(CancellationToken = exports.CancellationToken || (exports.CancellationToken = {}));\nconst shortcutEvent = Object.freeze(function (callback, context) {\n    const handle = ral_1.default().timer.setTimeout(callback.bind(context), 0);\n    return { dispose() { ral_1.default().timer.clearTimeout(handle); } };\n});\nclass MutableToken {\n    constructor() {\n        this._isCancelled = false;\n    }\n    cancel() {\n        if (!this._isCancelled) {\n            this._isCancelled = true;\n            if (this._emitter) {\n                this._emitter.fire(undefined);\n                this.dispose();\n            }\n        }\n    }\n    get isCancellationRequested() {\n        return this._isCancelled;\n    }\n    get onCancellationRequested() {\n        if (this._isCancelled) {\n            return shortcutEvent;\n        }\n        if (!this._emitter) {\n            this._emitter = new events_1.Emitter();\n        }\n        return this._emitter.event;\n    }\n    dispose() {\n        if (this._emitter) {\n            this._emitter.dispose();\n            this._emitter = undefined;\n        }\n    }\n}\nclass CancellationTokenSource {\n    get token() {\n        if (!this._token) {\n            // be lazy and create the token only when\n            // actually needed\n            this._token = new MutableToken();\n        }\n        return this._token;\n    }\n    cancel() {\n        if (!this._token) {\n            // save an object by returning the default\n            // cancelled token when cancellation happens\n            // before someone asks for the token\n            this._token = CancellationToken.Cancelled;\n        }\n        else {\n            this._token.cancel();\n        }\n    }\n    dispose() {\n        if (!this._token) {\n            // ensure to initialize with an empty token if we had none\n            this._token = CancellationToken.None;\n        }\n        else if (this._token instanceof MutableToken) {\n            // actually dispose\n            this._token.dispose();\n        }\n    }\n}\nexports.CancellationTokenSource = CancellationTokenSource;\n//# sourceMappingURL=cancellation.js.map"],"mappings":"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"},"metadata":{},"sourceType":"script"}