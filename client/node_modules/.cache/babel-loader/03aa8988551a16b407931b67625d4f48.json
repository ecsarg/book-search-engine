{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.printBlockString = exports.printType = exports.printIntrospectionSchema = exports.printSupergraphSdl = void 0;\n\nconst graphql_1 = require(\"graphql\");\n\nconst utilities_1 = require(\"../utilities\");\n\nconst coreSpec_1 = require(\"../coreSpec\");\n\nconst joinSpec_1 = require(\"../joinSpec\");\n\nconst utils_1 = require(\"../composition/utils\");\n\nconst directives_1 = require(\"../directives\");\n\nfunction printSupergraphSdl(schema, serviceList, options) {\n  const config = schema.toConfig();\n  const {\n    FieldSetScalar,\n    JoinFieldDirective,\n    JoinTypeDirective,\n    JoinOwnerDirective,\n    JoinGraphEnum,\n    JoinGraphDirective,\n    graphNameToEnumValueName\n  } = joinSpec_1.getJoinDefinitions(serviceList);\n  schema = new graphql_1.GraphQLSchema({ ...config,\n    directives: [coreSpec_1.CoreDirective, JoinFieldDirective, JoinTypeDirective, JoinOwnerDirective, JoinGraphDirective, ...config.directives],\n    types: [FieldSetScalar, JoinGraphEnum, ...config.types]\n  });\n  const context = {\n    graphNameToEnumValueName\n  };\n  return printFilteredSchema(schema, n => !graphql_1.isSpecifiedDirective(n), isDefinedType, context, options);\n}\n\nexports.printSupergraphSdl = printSupergraphSdl;\n\nfunction printIntrospectionSchema(schema, options) {\n  return printFilteredSchema(schema, graphql_1.isSpecifiedDirective, graphql_1.isIntrospectionType, {}, options);\n}\n\nexports.printIntrospectionSchema = printIntrospectionSchema;\n\nfunction isDefinedType(type) {\n  return !graphql_1.isSpecifiedScalarType(type) && !graphql_1.isIntrospectionType(type);\n}\n\nfunction printFilteredSchema(schema, directiveFilter, typeFilter, context, options) {\n  const directives = schema.getDirectives().filter(directiveFilter);\n  const types = Object.values(schema.getTypeMap()).sort((type1, type2) => type1.name.localeCompare(type2.name)).filter(typeFilter);\n  return [printSchemaDefinition(schema)].concat(directives.map(directive => printDirective(directive, options)), types.map(type => printType(type, context, options))).filter(Boolean).join('\\n\\n') + '\\n';\n}\n\nfunction printSchemaDefinition(schema) {\n  const operationTypes = [];\n  const queryType = schema.getQueryType();\n\n  if (queryType) {\n    operationTypes.push(`  query: ${queryType.name}`);\n  }\n\n  const mutationType = schema.getMutationType();\n\n  if (mutationType) {\n    operationTypes.push(`  mutation: ${mutationType.name}`);\n  }\n\n  const subscriptionType = schema.getSubscriptionType();\n\n  if (subscriptionType) {\n    operationTypes.push(`  subscription: ${subscriptionType.name}`);\n  }\n\n  return 'schema' + printCoreDirectives(schema) + `\\n{\\n${operationTypes.join('\\n')}\\n}`;\n}\n\nfunction printCoreDirectives(schema) {\n  const otherKnownDirectiveNames = directives_1.otherKnownDirectiveDefinitions.map(({\n    name\n  }) => name);\n  const schemaDirectiveNames = schema.getDirectives().map(({\n    name\n  }) => name);\n  const otherKnownDirectivesToInclude = schemaDirectiveNames.filter(name => otherKnownDirectiveNames.includes(name));\n  const otherKnownDirectiveSpecUrls = otherKnownDirectivesToInclude.map(name => `https://specs.apollo.dev/${name}/v0.1`);\n  return ['https://specs.apollo.dev/core/v0.1', 'https://specs.apollo.dev/join/v0.1', ...otherKnownDirectiveSpecUrls].map(feature => `\\n  @core(feature: ${printStringLiteral(feature)})`);\n}\n\nfunction printType(type, context, options) {\n  if (graphql_1.isScalarType(type)) {\n    return printScalar(type, options);\n  } else if (graphql_1.isObjectType(type)) {\n    return printObject(type, context, options);\n  } else if (graphql_1.isInterfaceType(type)) {\n    return printInterface(type, context, options);\n  } else if (graphql_1.isUnionType(type)) {\n    return printUnion(type, options);\n  } else if (graphql_1.isEnumType(type)) {\n    return printEnum(type, options);\n  } else if (graphql_1.isInputObjectType(type)) {\n    return printInputObject(type, options);\n  }\n\n  throw Error('Unexpected type: ' + type.toString());\n}\n\nexports.printType = printType;\n\nfunction printScalar(type, options) {\n  return printDescription(options, type) + `scalar ${type.name}`;\n}\n\nfunction printObject(type, context, options) {\n  const interfaces = type.getInterfaces();\n  const implementedInterfaces = interfaces.length ? ' implements ' + interfaces.map(i => i.name).join(' & ') : '';\n  return printDescription(options, type) + `type ${type.name}` + implementedInterfaces + printTypeJoinDirectives(type, context) + printFields(options, type, context);\n}\n\nfunction printTypeJoinDirectives(type, context) {\n  var _a, _b;\n\n  const metadata = (_a = type.extensions) === null || _a === void 0 ? void 0 : _a.federation;\n  if (!metadata) return '';\n  const {\n    serviceName: ownerService,\n    keys\n  } = metadata;\n  if (!ownerService || !keys) return '';\n  const {\n    [ownerService]: ownerKeys = [],\n    ...restKeys\n  } = keys;\n  const ownerEntry = [ownerService, ownerKeys];\n  const restEntries = Object.entries(restKeys);\n  const shouldPrintOwner = graphql_1.isObjectType(type);\n  const ownerGraphEnumValue = (_b = context.graphNameToEnumValueName) === null || _b === void 0 ? void 0 : _b[ownerService];\n  utilities_1.assert(ownerGraphEnumValue, `Unexpected enum value missing for subgraph ${ownerService}`);\n  const joinOwnerString = shouldPrintOwner ? `\\n  @join__owner(graph: ${ownerGraphEnumValue})` : '';\n  return joinOwnerString + [ownerEntry, ...restEntries].map(([service, keys = []]) => keys.map(selections => {\n    var _a;\n\n    const typeGraphEnumValue = (_a = context.graphNameToEnumValueName) === null || _a === void 0 ? void 0 : _a[service];\n    utilities_1.assert(typeGraphEnumValue, `Unexpected enum value missing for subgraph ${service}`);\n    return `\\n  @join__type(graph: ${typeGraphEnumValue}, key: ${printStringLiteral(utils_1.printFieldSet(selections))})`;\n  }).join('')).join('');\n}\n\nfunction printInterface(type, context, options) {\n  return printDescription(options, type) + `interface ${type.name}` + printTypeJoinDirectives(type, context) + printFields(options, type, context);\n}\n\nfunction printUnion(type, options) {\n  const types = type.getTypes();\n  const possibleTypes = types.length ? ' = ' + types.join(' | ') : '';\n  return printDescription(options, type) + 'union ' + type.name + possibleTypes;\n}\n\nfunction printEnum(type, options) {\n  const values = type.getValues().map((value, i) => printDescription(options, value, '  ', !i) + '  ' + value.name + printDeprecated(value) + printDirectivesOnEnumValue(type, value));\n  return printDescription(options, type) + `enum ${type.name}` + printBlock(values);\n}\n\nfunction printDirectivesOnEnumValue(type, value) {\n  var _a;\n\n  if (type.name === \"join__Graph\") {\n    return ` @join__graph(name: ${printStringLiteral(value.value.name)} url: ${printStringLiteral((_a = value.value.url) !== null && _a !== void 0 ? _a : '')})`;\n  }\n\n  return '';\n}\n\nfunction printInputObject(type, options) {\n  const fields = Object.values(type.getFields()).map((f, i) => printDescription(options, f, '  ', !i) + '  ' + printInputValue(f));\n  return printDescription(options, type) + `input ${type.name}` + printBlock(fields);\n}\n\nfunction printFields(options, type, context) {\n  var _a, _b;\n\n  const fields = Object.values(type.getFields()).map((f, i) => printDescription(options, f, '  ', !i) + '  ' + f.name + printArgs(options, f.args, '  ') + ': ' + String(f.type) + printDeprecated(f) + (graphql_1.isObjectType(type) ? printJoinFieldDirectives(f, type, context) + printOtherKnownDirectiveUsages(f) : ''));\n  const isEntity = Boolean((_b = (_a = type.extensions) === null || _a === void 0 ? void 0 : _a.federation) === null || _b === void 0 ? void 0 : _b.keys);\n  return printBlock(fields, isEntity);\n}\n\nfunction printJoinFieldDirectives(field, parentType, context) {\n  var _a, _b, _c, _d;\n\n  const directiveArgs = [];\n  const fieldMetadata = (_a = field.extensions) === null || _a === void 0 ? void 0 : _a.federation;\n  let serviceName = fieldMetadata === null || fieldMetadata === void 0 ? void 0 : fieldMetadata.serviceName;\n\n  if (!serviceName && ((_b = parentType.extensions) === null || _b === void 0 ? void 0 : _b.federation.keys)) {\n    serviceName = (_c = parentType.extensions) === null || _c === void 0 ? void 0 : _c.federation.serviceName;\n  }\n\n  if (serviceName) {\n    const enumValue = (_d = context.graphNameToEnumValueName) === null || _d === void 0 ? void 0 : _d[serviceName];\n    utilities_1.assert(enumValue, `Unexpected enum value missing for subgraph ${serviceName}`);\n    directiveArgs.push(`graph: ${enumValue}`);\n  }\n\n  const requires = fieldMetadata === null || fieldMetadata === void 0 ? void 0 : fieldMetadata.requires;\n\n  if (requires && requires.length > 0) {\n    directiveArgs.push(`requires: ${printStringLiteral(utils_1.printFieldSet(requires))}`);\n  }\n\n  const provides = fieldMetadata === null || fieldMetadata === void 0 ? void 0 : fieldMetadata.provides;\n\n  if (provides && provides.length > 0) {\n    directiveArgs.push(`provides: ${printStringLiteral(utils_1.printFieldSet(provides))}`);\n  }\n\n  if (directiveArgs.length < 1) return '';\n  return ` @join__field(${directiveArgs.join(', ')})`;\n}\n\nfunction printOtherKnownDirectiveUsages(field) {\n  var _a, _b, _c;\n\n  const otherKnownDirectiveUsages = (_c = (_b = (_a = field.extensions) === null || _a === void 0 ? void 0 : _a.federation) === null || _b === void 0 ? void 0 : _b.otherKnownDirectiveUsages) !== null && _c !== void 0 ? _c : [];\n  if (otherKnownDirectiveUsages.length < 1) return '';\n  return ` ${otherKnownDirectiveUsages.slice().sort((a, b) => a.name.value.localeCompare(b.name.value)).map(graphql_1.print).join(' ')}`;\n}\n\n;\n\nfunction printBlock(items, onNewLine) {\n  return items.length !== 0 ? onNewLine ? '\\n{\\n' + items.join('\\n') + '\\n}' : ' {\\n' + items.join('\\n') + '\\n}' : '';\n}\n\nfunction printArgs(options, args, indentation = '') {\n  if (args.length === 0) {\n    return '';\n  }\n\n  if (args.every(arg => !arg.description)) {\n    return '(' + args.map(printInputValue).join(', ') + ')';\n  }\n\n  return '(\\n' + args.map((arg, i) => printDescription(options, arg, '  ' + indentation, !i) + '  ' + indentation + printInputValue(arg)).join('\\n') + '\\n' + indentation + ')';\n}\n\nfunction printInputValue(arg) {\n  const defaultAST = graphql_1.astFromValue(arg.defaultValue, arg.type);\n  let argDecl = arg.name + ': ' + String(arg.type);\n\n  if (defaultAST) {\n    argDecl += ` = ${graphql_1.print(defaultAST)}`;\n  }\n\n  return argDecl;\n}\n\nfunction printDirective(directive, options) {\n  return printDescription(options, directive) + 'directive @' + directive.name + printArgs(options, directive.args) + (directive.isRepeatable ? ' repeatable' : '') + ' on ' + directive.locations.join(' | ');\n}\n\nfunction printDeprecated(fieldOrEnumVal) {\n  if (!fieldOrEnumVal.isDeprecated) {\n    return '';\n  }\n\n  const reason = fieldOrEnumVal.deprecationReason;\n  const reasonAST = graphql_1.astFromValue(reason, graphql_1.GraphQLString);\n\n  if (reasonAST && reason !== graphql_1.DEFAULT_DEPRECATION_REASON) {\n    return ' @deprecated(reason: ' + graphql_1.print(reasonAST) + ')';\n  }\n\n  return ' @deprecated';\n}\n\nfunction printDescription(options, def, indentation = '', firstInBlock = true) {\n  const {\n    description\n  } = def;\n\n  if (description == null) {\n    return '';\n  }\n\n  if ((options === null || options === void 0 ? void 0 : options.commentDescriptions) === true) {\n    return printDescriptionWithComments(description, indentation, firstInBlock);\n  }\n\n  const preferMultipleLines = description.length > 70;\n  const blockString = printBlockString(description, '', preferMultipleLines);\n  const prefix = indentation && !firstInBlock ? '\\n' + indentation : indentation;\n  return prefix + blockString.replace(/\\n/g, '\\n' + indentation) + '\\n';\n}\n\nfunction printDescriptionWithComments(description, indentation, firstInBlock) {\n  const prefix = indentation && !firstInBlock ? '\\n' : '';\n  const comment = description.split('\\n').map(line => indentation + (line !== '' ? '# ' + line : '#')).join('\\n');\n  return prefix + comment + '\\n';\n}\n\nfunction printStringLiteral(value) {\n  return JSON.stringify(value);\n}\n\nfunction printBlockString(value, indentation = '', preferMultipleLines = false) {\n  const isSingleLine = value.indexOf('\\n') === -1;\n  const hasLeadingSpace = value[0] === ' ' || value[0] === '\\t';\n  const hasTrailingQuote = value[value.length - 1] === '\"';\n  const hasTrailingSlash = value[value.length - 1] === '\\\\';\n  const printAsMultipleLines = !isSingleLine || hasTrailingQuote || hasTrailingSlash || preferMultipleLines;\n  let result = '';\n\n  if (printAsMultipleLines && !(isSingleLine && hasLeadingSpace)) {\n    result += '\\n' + indentation;\n  }\n\n  result += indentation ? value.replace(/\\n/g, '\\n' + indentation) : value;\n\n  if (printAsMultipleLines) {\n    result += '\\n';\n  }\n\n  return '\"\"\"' + result.replace(/\"\"\"/g, '\\\\\"\"\"') + '\"\"\"';\n}\n\nexports.printBlockString = printBlockString;","map":{"version":3,"sources":["../../src/service/printSupergraphSdl.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.printBlockString = exports.printType = exports.printIntrospectionSchema = exports.printSupergraphSdl = void 0;\nconst graphql_1 = require(\"graphql\");\nconst utilities_1 = require(\"../utilities\");\nconst coreSpec_1 = require(\"../coreSpec\");\nconst joinSpec_1 = require(\"../joinSpec\");\nconst utils_1 = require(\"../composition/utils\");\nconst directives_1 = require(\"../directives\");\nfunction printSupergraphSdl(schema, serviceList, options) {\n    const config = schema.toConfig();\n    const { FieldSetScalar, JoinFieldDirective, JoinTypeDirective, JoinOwnerDirective, JoinGraphEnum, JoinGraphDirective, graphNameToEnumValueName, } = joinSpec_1.getJoinDefinitions(serviceList);\n    schema = new graphql_1.GraphQLSchema({\n        ...config,\n        directives: [\n            coreSpec_1.CoreDirective,\n            JoinFieldDirective,\n            JoinTypeDirective,\n            JoinOwnerDirective,\n            JoinGraphDirective,\n            ...config.directives,\n        ],\n        types: [FieldSetScalar, JoinGraphEnum, ...config.types],\n    });\n    const context = {\n        graphNameToEnumValueName,\n    };\n    return printFilteredSchema(schema, (n) => !graphql_1.isSpecifiedDirective(n), isDefinedType, context, options);\n}\nexports.printSupergraphSdl = printSupergraphSdl;\nfunction printIntrospectionSchema(schema, options) {\n    return printFilteredSchema(schema, graphql_1.isSpecifiedDirective, graphql_1.isIntrospectionType, {}, options);\n}\nexports.printIntrospectionSchema = printIntrospectionSchema;\nfunction isDefinedType(type) {\n    return !graphql_1.isSpecifiedScalarType(type) && !graphql_1.isIntrospectionType(type);\n}\nfunction printFilteredSchema(schema, directiveFilter, typeFilter, context, options) {\n    const directives = schema.getDirectives().filter(directiveFilter);\n    const types = Object.values(schema.getTypeMap())\n        .sort((type1, type2) => type1.name.localeCompare(type2.name))\n        .filter(typeFilter);\n    return ([printSchemaDefinition(schema)]\n        .concat(directives.map((directive) => printDirective(directive, options)), types.map((type) => printType(type, context, options)))\n        .filter(Boolean)\n        .join('\\n\\n') + '\\n');\n}\nfunction printSchemaDefinition(schema) {\n    const operationTypes = [];\n    const queryType = schema.getQueryType();\n    if (queryType) {\n        operationTypes.push(`  query: ${queryType.name}`);\n    }\n    const mutationType = schema.getMutationType();\n    if (mutationType) {\n        operationTypes.push(`  mutation: ${mutationType.name}`);\n    }\n    const subscriptionType = schema.getSubscriptionType();\n    if (subscriptionType) {\n        operationTypes.push(`  subscription: ${subscriptionType.name}`);\n    }\n    return ('schema' +\n        printCoreDirectives(schema) +\n        `\\n{\\n${operationTypes.join('\\n')}\\n}`);\n}\nfunction printCoreDirectives(schema) {\n    const otherKnownDirectiveNames = directives_1.otherKnownDirectiveDefinitions.map(({ name }) => name);\n    const schemaDirectiveNames = schema.getDirectives().map(({ name }) => name);\n    const otherKnownDirectivesToInclude = schemaDirectiveNames.filter((name) => otherKnownDirectiveNames.includes(name));\n    const otherKnownDirectiveSpecUrls = otherKnownDirectivesToInclude.map((name) => `https://specs.apollo.dev/${name}/v0.1`);\n    return [\n        'https://specs.apollo.dev/core/v0.1',\n        'https://specs.apollo.dev/join/v0.1',\n        ...otherKnownDirectiveSpecUrls,\n    ].map((feature) => `\\n  @core(feature: ${printStringLiteral(feature)})`);\n}\nfunction printType(type, context, options) {\n    if (graphql_1.isScalarType(type)) {\n        return printScalar(type, options);\n    }\n    else if (graphql_1.isObjectType(type)) {\n        return printObject(type, context, options);\n    }\n    else if (graphql_1.isInterfaceType(type)) {\n        return printInterface(type, context, options);\n    }\n    else if (graphql_1.isUnionType(type)) {\n        return printUnion(type, options);\n    }\n    else if (graphql_1.isEnumType(type)) {\n        return printEnum(type, options);\n    }\n    else if (graphql_1.isInputObjectType(type)) {\n        return printInputObject(type, options);\n    }\n    throw Error('Unexpected type: ' + type.toString());\n}\nexports.printType = printType;\nfunction printScalar(type, options) {\n    return printDescription(options, type) + `scalar ${type.name}`;\n}\nfunction printObject(type, context, options) {\n    const interfaces = type.getInterfaces();\n    const implementedInterfaces = interfaces.length\n        ? ' implements ' + interfaces.map((i) => i.name).join(' & ')\n        : '';\n    return (printDescription(options, type) +\n        `type ${type.name}` +\n        implementedInterfaces +\n        printTypeJoinDirectives(type, context) +\n        printFields(options, type, context));\n}\nfunction printTypeJoinDirectives(type, context) {\n    var _a, _b;\n    const metadata = (_a = type.extensions) === null || _a === void 0 ? void 0 : _a.federation;\n    if (!metadata)\n        return '';\n    const { serviceName: ownerService, keys } = metadata;\n    if (!ownerService || !keys)\n        return '';\n    const { [ownerService]: ownerKeys = [], ...restKeys } = keys;\n    const ownerEntry = [\n        ownerService,\n        ownerKeys,\n    ];\n    const restEntries = Object.entries(restKeys);\n    const shouldPrintOwner = graphql_1.isObjectType(type);\n    const ownerGraphEnumValue = (_b = context.graphNameToEnumValueName) === null || _b === void 0 ? void 0 : _b[ownerService];\n    utilities_1.assert(ownerGraphEnumValue, `Unexpected enum value missing for subgraph ${ownerService}`);\n    const joinOwnerString = shouldPrintOwner\n        ? `\\n  @join__owner(graph: ${ownerGraphEnumValue})`\n        : '';\n    return (joinOwnerString +\n        [ownerEntry, ...restEntries]\n            .map(([service, keys = []]) => keys\n            .map((selections) => {\n            var _a;\n            const typeGraphEnumValue = (_a = context.graphNameToEnumValueName) === null || _a === void 0 ? void 0 : _a[service];\n            utilities_1.assert(typeGraphEnumValue, `Unexpected enum value missing for subgraph ${service}`);\n            return `\\n  @join__type(graph: ${typeGraphEnumValue}, key: ${printStringLiteral(utils_1.printFieldSet(selections))})`;\n        })\n            .join(''))\n            .join(''));\n}\nfunction printInterface(type, context, options) {\n    return (printDescription(options, type) +\n        `interface ${type.name}` +\n        printTypeJoinDirectives(type, context) +\n        printFields(options, type, context));\n}\nfunction printUnion(type, options) {\n    const types = type.getTypes();\n    const possibleTypes = types.length ? ' = ' + types.join(' | ') : '';\n    return printDescription(options, type) + 'union ' + type.name + possibleTypes;\n}\nfunction printEnum(type, options) {\n    const values = type\n        .getValues()\n        .map((value, i) => printDescription(options, value, '  ', !i) +\n        '  ' +\n        value.name +\n        printDeprecated(value) +\n        printDirectivesOnEnumValue(type, value));\n    return (printDescription(options, type) + `enum ${type.name}` + printBlock(values));\n}\nfunction printDirectivesOnEnumValue(type, value) {\n    var _a;\n    if (type.name === \"join__Graph\") {\n        return ` @join__graph(name: ${printStringLiteral((value.value.name))} url: ${printStringLiteral((_a = value.value.url) !== null && _a !== void 0 ? _a : '')})`;\n    }\n    return '';\n}\nfunction printInputObject(type, options) {\n    const fields = Object.values(type.getFields()).map((f, i) => printDescription(options, f, '  ', !i) + '  ' + printInputValue(f));\n    return (printDescription(options, type) + `input ${type.name}` + printBlock(fields));\n}\nfunction printFields(options, type, context) {\n    var _a, _b;\n    const fields = Object.values(type.getFields()).map((f, i) => printDescription(options, f, '  ', !i) +\n        '  ' +\n        f.name +\n        printArgs(options, f.args, '  ') +\n        ': ' +\n        String(f.type) +\n        printDeprecated(f) +\n        (graphql_1.isObjectType(type)\n            ? printJoinFieldDirectives(f, type, context) +\n                printOtherKnownDirectiveUsages(f)\n            : ''));\n    const isEntity = Boolean((_b = (_a = type.extensions) === null || _a === void 0 ? void 0 : _a.federation) === null || _b === void 0 ? void 0 : _b.keys);\n    return printBlock(fields, isEntity);\n}\nfunction printJoinFieldDirectives(field, parentType, context) {\n    var _a, _b, _c, _d;\n    const directiveArgs = [];\n    const fieldMetadata = (_a = field.extensions) === null || _a === void 0 ? void 0 : _a.federation;\n    let serviceName = fieldMetadata === null || fieldMetadata === void 0 ? void 0 : fieldMetadata.serviceName;\n    if (!serviceName && ((_b = parentType.extensions) === null || _b === void 0 ? void 0 : _b.federation.keys)) {\n        serviceName = (_c = parentType.extensions) === null || _c === void 0 ? void 0 : _c.federation.serviceName;\n    }\n    if (serviceName) {\n        const enumValue = (_d = context.graphNameToEnumValueName) === null || _d === void 0 ? void 0 : _d[serviceName];\n        utilities_1.assert(enumValue, `Unexpected enum value missing for subgraph ${serviceName}`);\n        directiveArgs.push(`graph: ${enumValue}`);\n    }\n    const requires = fieldMetadata === null || fieldMetadata === void 0 ? void 0 : fieldMetadata.requires;\n    if (requires && requires.length > 0) {\n        directiveArgs.push(`requires: ${printStringLiteral(utils_1.printFieldSet(requires))}`);\n    }\n    const provides = fieldMetadata === null || fieldMetadata === void 0 ? void 0 : fieldMetadata.provides;\n    if (provides && provides.length > 0) {\n        directiveArgs.push(`provides: ${printStringLiteral(utils_1.printFieldSet(provides))}`);\n    }\n    if (directiveArgs.length < 1)\n        return '';\n    return ` @join__field(${directiveArgs.join(', ')})`;\n}\nfunction printOtherKnownDirectiveUsages(field) {\n    var _a, _b, _c;\n    const otherKnownDirectiveUsages = ((_c = (_b = (_a = field.extensions) === null || _a === void 0 ? void 0 : _a.federation) === null || _b === void 0 ? void 0 : _b.otherKnownDirectiveUsages) !== null && _c !== void 0 ? _c : []);\n    if (otherKnownDirectiveUsages.length < 1)\n        return '';\n    return ` ${otherKnownDirectiveUsages\n        .slice()\n        .sort((a, b) => a.name.value.localeCompare(b.name.value))\n        .map(graphql_1.print)\n        .join(' ')}`;\n}\n;\nfunction printBlock(items, onNewLine) {\n    return items.length !== 0\n        ? onNewLine\n            ? '\\n{\\n' + items.join('\\n') + '\\n}'\n            : ' {\\n' + items.join('\\n') + '\\n}'\n        : '';\n}\nfunction printArgs(options, args, indentation = '') {\n    if (args.length === 0) {\n        return '';\n    }\n    if (args.every((arg) => !arg.description)) {\n        return '(' + args.map(printInputValue).join(', ') + ')';\n    }\n    return ('(\\n' +\n        args\n            .map((arg, i) => printDescription(options, arg, '  ' + indentation, !i) +\n            '  ' +\n            indentation +\n            printInputValue(arg))\n            .join('\\n') +\n        '\\n' +\n        indentation +\n        ')');\n}\nfunction printInputValue(arg) {\n    const defaultAST = graphql_1.astFromValue(arg.defaultValue, arg.type);\n    let argDecl = arg.name + ': ' + String(arg.type);\n    if (defaultAST) {\n        argDecl += ` = ${graphql_1.print(defaultAST)}`;\n    }\n    return argDecl;\n}\nfunction printDirective(directive, options) {\n    return (printDescription(options, directive) +\n        'directive @' +\n        directive.name +\n        printArgs(options, directive.args) +\n        (directive.isRepeatable ? ' repeatable' : '') +\n        ' on ' +\n        directive.locations.join(' | '));\n}\nfunction printDeprecated(fieldOrEnumVal) {\n    if (!fieldOrEnumVal.isDeprecated) {\n        return '';\n    }\n    const reason = fieldOrEnumVal.deprecationReason;\n    const reasonAST = graphql_1.astFromValue(reason, graphql_1.GraphQLString);\n    if (reasonAST && reason !== graphql_1.DEFAULT_DEPRECATION_REASON) {\n        return ' @deprecated(reason: ' + graphql_1.print(reasonAST) + ')';\n    }\n    return ' @deprecated';\n}\nfunction printDescription(options, def, indentation = '', firstInBlock = true) {\n    const { description } = def;\n    if (description == null) {\n        return '';\n    }\n    if ((options === null || options === void 0 ? void 0 : options.commentDescriptions) === true) {\n        return printDescriptionWithComments(description, indentation, firstInBlock);\n    }\n    const preferMultipleLines = description.length > 70;\n    const blockString = printBlockString(description, '', preferMultipleLines);\n    const prefix = indentation && !firstInBlock ? '\\n' + indentation : indentation;\n    return prefix + blockString.replace(/\\n/g, '\\n' + indentation) + '\\n';\n}\nfunction printDescriptionWithComments(description, indentation, firstInBlock) {\n    const prefix = indentation && !firstInBlock ? '\\n' : '';\n    const comment = description\n        .split('\\n')\n        .map((line) => indentation + (line !== '' ? '# ' + line : '#'))\n        .join('\\n');\n    return prefix + comment + '\\n';\n}\nfunction printStringLiteral(value) {\n    return JSON.stringify(value);\n}\nfunction printBlockString(value, indentation = '', preferMultipleLines = false) {\n    const isSingleLine = value.indexOf('\\n') === -1;\n    const hasLeadingSpace = value[0] === ' ' || value[0] === '\\t';\n    const hasTrailingQuote = value[value.length - 1] === '\"';\n    const hasTrailingSlash = value[value.length - 1] === '\\\\';\n    const printAsMultipleLines = !isSingleLine ||\n        hasTrailingQuote ||\n        hasTrailingSlash ||\n        preferMultipleLines;\n    let result = '';\n    if (printAsMultipleLines && !(isSingleLine && hasLeadingSpace)) {\n        result += '\\n' + indentation;\n    }\n    result += indentation ? value.replace(/\\n/g, '\\n' + indentation) : value;\n    if (printAsMultipleLines) {\n        result += '\\n';\n    }\n    return '\"\"\"' + result.replace(/\"\"\"/g, '\\\\\"\"\"') + '\"\"\"';\n}\nexports.printBlockString = printBlockString;\n//# sourceMappingURL=printSupergraphSdl.js.map"]},"metadata":{},"sourceType":"script"}