{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.transformSchema = void 0;\n\nconst graphql_1 = require(\"graphql\");\n\nconst mapValues_1 = require(\"../utilities/mapValues\");\n\nfunction transformSchema(schema, transformType) {\n  const typeMap = Object.create(null);\n\n  for (const oldType of Object.values(schema.getTypeMap())) {\n    if ((0, graphql_1.isIntrospectionType)(oldType)) continue;\n    const result = transformType(oldType);\n    if (result === null) continue;\n    const newType = result || oldType;\n    typeMap[newType.name] = recreateNamedType(newType);\n  }\n\n  const schemaConfig = schema.toConfig();\n  return new graphql_1.GraphQLSchema(Object.assign(Object.assign({}, schemaConfig), {\n    types: Object.values(typeMap),\n    query: replaceMaybeType(schemaConfig.query),\n    mutation: replaceMaybeType(schemaConfig.mutation),\n    subscription: replaceMaybeType(schemaConfig.subscription),\n    directives: replaceDirectives(schemaConfig.directives)\n  }));\n\n  function recreateNamedType(type) {\n    if ((0, graphql_1.isObjectType)(type)) {\n      const config = type.toConfig();\n      return new graphql_1.GraphQLObjectType(Object.assign(Object.assign({}, config), {\n        interfaces: () => config.interfaces.map(replaceNamedType),\n        fields: () => replaceFields(config.fields)\n      }));\n    } else if ((0, graphql_1.isInterfaceType)(type)) {\n      const config = type.toConfig();\n      return new graphql_1.GraphQLInterfaceType(Object.assign(Object.assign({}, config), {\n        interfaces: () => config.interfaces.map(replaceNamedType),\n        fields: () => replaceFields(config.fields)\n      }));\n    } else if ((0, graphql_1.isUnionType)(type)) {\n      const config = type.toConfig();\n      return new graphql_1.GraphQLUnionType(Object.assign(Object.assign({}, config), {\n        types: () => config.types.map(replaceNamedType)\n      }));\n    } else if ((0, graphql_1.isInputObjectType)(type)) {\n      const config = type.toConfig();\n      return new graphql_1.GraphQLInputObjectType(Object.assign(Object.assign({}, config), {\n        fields: () => replaceInputFields(config.fields)\n      }));\n    }\n\n    return type;\n  }\n\n  function replaceType(type) {\n    if ((0, graphql_1.isListType)(type)) {\n      return new graphql_1.GraphQLList(replaceType(type.ofType));\n    } else if ((0, graphql_1.isNonNullType)(type)) {\n      return new graphql_1.GraphQLNonNull(replaceType(type.ofType));\n    }\n\n    return replaceNamedType(type);\n  }\n\n  function replaceNamedType(type) {\n    const newType = typeMap[type.name];\n    return newType ? newType : type;\n  }\n\n  function replaceMaybeType(type) {\n    return type ? replaceNamedType(type) : undefined;\n  }\n\n  function replaceFields(fieldsMap) {\n    return (0, mapValues_1.mapValues)(fieldsMap, field => Object.assign(Object.assign({}, field), {\n      type: replaceType(field.type),\n      args: field.args ? replaceArgs(field.args) : undefined\n    }));\n  }\n\n  function replaceInputFields(fieldsMap) {\n    return (0, mapValues_1.mapValues)(fieldsMap, field => Object.assign(Object.assign({}, field), {\n      type: replaceType(field.type)\n    }));\n  }\n\n  function replaceArgs(args) {\n    return (0, mapValues_1.mapValues)(args, arg => Object.assign(Object.assign({}, arg), {\n      type: replaceType(arg.type)\n    }));\n  }\n\n  function replaceDirectives(directives) {\n    return directives.map(directive => {\n      const config = directive.toConfig();\n      return new graphql_1.GraphQLDirective(Object.assign(Object.assign({}, config), {\n        args: replaceArgs(config.args)\n      }));\n    });\n  }\n}\n\nexports.transformSchema = transformSchema;","map":{"version":3,"sources":["../../src/schema/transformSchema.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.transformSchema = void 0;\nconst graphql_1 = require(\"graphql\");\nconst mapValues_1 = require(\"../utilities/mapValues\");\nfunction transformSchema(schema, transformType) {\n    const typeMap = Object.create(null);\n    for (const oldType of Object.values(schema.getTypeMap())) {\n        if ((0, graphql_1.isIntrospectionType)(oldType))\n            continue;\n        const result = transformType(oldType);\n        if (result === null)\n            continue;\n        const newType = result || oldType;\n        typeMap[newType.name] = recreateNamedType(newType);\n    }\n    const schemaConfig = schema.toConfig();\n    return new graphql_1.GraphQLSchema(Object.assign(Object.assign({}, schemaConfig), { types: Object.values(typeMap), query: replaceMaybeType(schemaConfig.query), mutation: replaceMaybeType(schemaConfig.mutation), subscription: replaceMaybeType(schemaConfig.subscription), directives: replaceDirectives(schemaConfig.directives) }));\n    function recreateNamedType(type) {\n        if ((0, graphql_1.isObjectType)(type)) {\n            const config = type.toConfig();\n            return new graphql_1.GraphQLObjectType(Object.assign(Object.assign({}, config), { interfaces: () => config.interfaces.map(replaceNamedType), fields: () => replaceFields(config.fields) }));\n        }\n        else if ((0, graphql_1.isInterfaceType)(type)) {\n            const config = type.toConfig();\n            return new graphql_1.GraphQLInterfaceType(Object.assign(Object.assign({}, config), { interfaces: () => config.interfaces.map(replaceNamedType), fields: () => replaceFields(config.fields) }));\n        }\n        else if ((0, graphql_1.isUnionType)(type)) {\n            const config = type.toConfig();\n            return new graphql_1.GraphQLUnionType(Object.assign(Object.assign({}, config), { types: () => config.types.map(replaceNamedType) }));\n        }\n        else if ((0, graphql_1.isInputObjectType)(type)) {\n            const config = type.toConfig();\n            return new graphql_1.GraphQLInputObjectType(Object.assign(Object.assign({}, config), { fields: () => replaceInputFields(config.fields) }));\n        }\n        return type;\n    }\n    function replaceType(type) {\n        if ((0, graphql_1.isListType)(type)) {\n            return new graphql_1.GraphQLList(replaceType(type.ofType));\n        }\n        else if ((0, graphql_1.isNonNullType)(type)) {\n            return new graphql_1.GraphQLNonNull(replaceType(type.ofType));\n        }\n        return replaceNamedType(type);\n    }\n    function replaceNamedType(type) {\n        const newType = typeMap[type.name];\n        return newType ? newType : type;\n    }\n    function replaceMaybeType(type) {\n        return type ? replaceNamedType(type) : undefined;\n    }\n    function replaceFields(fieldsMap) {\n        return (0, mapValues_1.mapValues)(fieldsMap, (field) => (Object.assign(Object.assign({}, field), { type: replaceType(field.type), args: field.args ? replaceArgs(field.args) : undefined })));\n    }\n    function replaceInputFields(fieldsMap) {\n        return (0, mapValues_1.mapValues)(fieldsMap, (field) => (Object.assign(Object.assign({}, field), { type: replaceType(field.type) })));\n    }\n    function replaceArgs(args) {\n        return (0, mapValues_1.mapValues)(args, (arg) => (Object.assign(Object.assign({}, arg), { type: replaceType(arg.type) })));\n    }\n    function replaceDirectives(directives) {\n        return directives.map((directive) => {\n            const config = directive.toConfig();\n            return new graphql_1.GraphQLDirective(Object.assign(Object.assign({}, config), { args: replaceArgs(config.args) }));\n        });\n    }\n}\nexports.transformSchema = transformSchema;\n//# sourceMappingURL=transformSchema.js.map"]},"metadata":{},"sourceType":"script"}