{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.hasPersistedQueryError = exports.formatApolloErrors = exports.UserInputError = exports.PersistedQueryNotSupportedError = exports.PersistedQueryNotFoundError = exports.ForbiddenError = exports.AuthenticationError = exports.ValidationError = exports.SyntaxError = exports.fromGraphQLError = exports.toApolloError = exports.ApolloError = void 0;\n\nconst graphql_1 = require(\"graphql\");\n\nclass ApolloError extends Error {\n  constructor(message, code, extensions) {\n    super(message);\n\n    if (extensions) {\n      Object.keys(extensions).filter(keyName => keyName !== 'message' && keyName !== 'extensions').forEach(key => {\n        this[key] = extensions[key];\n      });\n    }\n\n    if (!this.name) {\n      Object.defineProperty(this, 'name', {\n        value: 'ApolloError'\n      });\n    }\n\n    const userProvidedExtensions = extensions && extensions.extensions || null;\n    this.extensions = Object.assign(Object.assign(Object.assign({}, extensions), userProvidedExtensions), {\n      code\n    });\n  }\n\n}\n\nexports.ApolloError = ApolloError;\n\nfunction enrichError(error, debug = false) {\n  const expanded = Object.create(Object.getPrototypeOf(error), {\n    name: {\n      value: error.name\n    },\n    message: {\n      value: error.message,\n      enumerable: true,\n      writable: true\n    },\n    locations: {\n      value: error.locations || undefined,\n      enumerable: true\n    },\n    path: {\n      value: error.path || undefined,\n      enumerable: true\n    },\n    nodes: {\n      value: error.nodes || undefined\n    },\n    source: {\n      value: error.source || undefined\n    },\n    positions: {\n      value: error.positions || undefined\n    },\n    originalError: {\n      value: error.originalError\n    }\n  });\n  expanded.extensions = Object.assign(Object.assign({}, error.extensions), {\n    code: error.extensions && error.extensions.code || 'INTERNAL_SERVER_ERROR',\n    exception: Object.assign(Object.assign({}, error.extensions && error.extensions.exception), error.originalError)\n  });\n  delete expanded.extensions.exception.extensions;\n\n  if (debug && !expanded.extensions.exception.stacktrace) {\n    expanded.extensions.exception.stacktrace = error.originalError && error.originalError.stack && error.originalError.stack.split('\\n') || error.stack && error.stack.split('\\n');\n  }\n\n  if (Object.keys(expanded.extensions.exception).length === 0) {\n    delete expanded.extensions.exception;\n  }\n\n  return expanded;\n}\n\nfunction toApolloError(error, code = 'INTERNAL_SERVER_ERROR') {\n  let err = error;\n\n  if (err.extensions) {\n    err.extensions.code = code;\n  } else {\n    err.extensions = {\n      code\n    };\n  }\n\n  return err;\n}\n\nexports.toApolloError = toApolloError;\n\nfunction fromGraphQLError(error, options) {\n  const copy = options && options.errorClass ? new options.errorClass(error.message) : new ApolloError(error.message);\n  Object.keys(error).forEach(key => {\n    copy[key] = error[key];\n  });\n  copy.extensions = Object.assign(Object.assign({}, copy.extensions), error.extensions);\n\n  if (!copy.extensions.code) {\n    copy.extensions.code = options && options.code || 'INTERNAL_SERVER_ERROR';\n  }\n\n  Object.defineProperty(copy, 'originalError', {\n    value: {}\n  });\n  Object.getOwnPropertyNames(error).forEach(key => {\n    Object.defineProperty(copy.originalError, key, {\n      value: error[key]\n    });\n  });\n  return copy;\n}\n\nexports.fromGraphQLError = fromGraphQLError;\n\nclass SyntaxError extends ApolloError {\n  constructor(message) {\n    super(message, 'GRAPHQL_PARSE_FAILED');\n    Object.defineProperty(this, 'name', {\n      value: 'SyntaxError'\n    });\n  }\n\n}\n\nexports.SyntaxError = SyntaxError;\n\nclass ValidationError extends ApolloError {\n  constructor(message) {\n    super(message, 'GRAPHQL_VALIDATION_FAILED');\n    Object.defineProperty(this, 'name', {\n      value: 'ValidationError'\n    });\n  }\n\n}\n\nexports.ValidationError = ValidationError;\n\nclass AuthenticationError extends ApolloError {\n  constructor(message) {\n    super(message, 'UNAUTHENTICATED');\n    Object.defineProperty(this, 'name', {\n      value: 'AuthenticationError'\n    });\n  }\n\n}\n\nexports.AuthenticationError = AuthenticationError;\n\nclass ForbiddenError extends ApolloError {\n  constructor(message) {\n    super(message, 'FORBIDDEN');\n    Object.defineProperty(this, 'name', {\n      value: 'ForbiddenError'\n    });\n  }\n\n}\n\nexports.ForbiddenError = ForbiddenError;\n\nclass PersistedQueryNotFoundError extends ApolloError {\n  constructor() {\n    super('PersistedQueryNotFound', 'PERSISTED_QUERY_NOT_FOUND');\n    Object.defineProperty(this, 'name', {\n      value: 'PersistedQueryNotFoundError'\n    });\n  }\n\n}\n\nexports.PersistedQueryNotFoundError = PersistedQueryNotFoundError;\n\nclass PersistedQueryNotSupportedError extends ApolloError {\n  constructor() {\n    super('PersistedQueryNotSupported', 'PERSISTED_QUERY_NOT_SUPPORTED');\n    Object.defineProperty(this, 'name', {\n      value: 'PersistedQueryNotSupportedError'\n    });\n  }\n\n}\n\nexports.PersistedQueryNotSupportedError = PersistedQueryNotSupportedError;\n\nclass UserInputError extends ApolloError {\n  constructor(message, properties) {\n    super(message, 'BAD_USER_INPUT', properties);\n    Object.defineProperty(this, 'name', {\n      value: 'UserInputError'\n    });\n  }\n\n}\n\nexports.UserInputError = UserInputError;\n\nfunction formatApolloErrors(errors, options) {\n  if (!options) {\n    return errors.map(error => enrichError(error));\n  }\n\n  const {\n    formatter,\n    debug\n  } = options;\n  const enrichedErrors = errors.map(error => enrichError(error, debug));\n\n  const makePrintable = error => {\n    if (error instanceof Error) {\n      const graphQLError = error;\n      return Object.assign(Object.assign(Object.assign({\n        message: graphQLError.message\n      }, graphQLError.locations && {\n        locations: graphQLError.locations\n      }), graphQLError.path && {\n        path: graphQLError.path\n      }), graphQLError.extensions && {\n        extensions: graphQLError.extensions\n      });\n    }\n\n    return error;\n  };\n\n  if (!formatter) {\n    return enrichedErrors;\n  }\n\n  return enrichedErrors.map(error => {\n    try {\n      return makePrintable(formatter(error));\n    } catch (err) {\n      if (debug) {\n        return enrichError(err, debug);\n      } else {\n        const newError = fromGraphQLError(new graphql_1.GraphQLError('Internal server error'));\n        return enrichError(newError, debug);\n      }\n    }\n  });\n}\n\nexports.formatApolloErrors = formatApolloErrors;\n\nfunction hasPersistedQueryError(errors) {\n  return Array.isArray(errors) ? errors.some(error => error instanceof PersistedQueryNotFoundError || error instanceof PersistedQueryNotSupportedError) : false;\n}\n\nexports.hasPersistedQueryError = hasPersistedQueryError;","map":{"version":3,"sources":["../src/index.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.hasPersistedQueryError = exports.formatApolloErrors = exports.UserInputError = exports.PersistedQueryNotSupportedError = exports.PersistedQueryNotFoundError = exports.ForbiddenError = exports.AuthenticationError = exports.ValidationError = exports.SyntaxError = exports.fromGraphQLError = exports.toApolloError = exports.ApolloError = void 0;\nconst graphql_1 = require(\"graphql\");\nclass ApolloError extends Error {\n    constructor(message, code, extensions) {\n        super(message);\n        if (extensions) {\n            Object.keys(extensions)\n                .filter(keyName => keyName !== 'message' && keyName !== 'extensions')\n                .forEach(key => {\n                this[key] = extensions[key];\n            });\n        }\n        if (!this.name) {\n            Object.defineProperty(this, 'name', { value: 'ApolloError' });\n        }\n        const userProvidedExtensions = (extensions && extensions.extensions) || null;\n        this.extensions = Object.assign(Object.assign(Object.assign({}, extensions), userProvidedExtensions), { code });\n    }\n}\nexports.ApolloError = ApolloError;\nfunction enrichError(error, debug = false) {\n    const expanded = Object.create(Object.getPrototypeOf(error), {\n        name: {\n            value: error.name,\n        },\n        message: {\n            value: error.message,\n            enumerable: true,\n            writable: true,\n        },\n        locations: {\n            value: error.locations || undefined,\n            enumerable: true,\n        },\n        path: {\n            value: error.path || undefined,\n            enumerable: true,\n        },\n        nodes: {\n            value: error.nodes || undefined,\n        },\n        source: {\n            value: error.source || undefined,\n        },\n        positions: {\n            value: error.positions || undefined,\n        },\n        originalError: {\n            value: error.originalError,\n        },\n    });\n    expanded.extensions = Object.assign(Object.assign({}, error.extensions), { code: (error.extensions && error.extensions.code) || 'INTERNAL_SERVER_ERROR', exception: Object.assign(Object.assign({}, (error.extensions && error.extensions.exception)), error.originalError) });\n    delete expanded.extensions.exception.extensions;\n    if (debug && !expanded.extensions.exception.stacktrace) {\n        expanded.extensions.exception.stacktrace =\n            (error.originalError &&\n                error.originalError.stack &&\n                error.originalError.stack.split('\\n')) ||\n                (error.stack && error.stack.split('\\n'));\n    }\n    if (Object.keys(expanded.extensions.exception).length === 0) {\n        delete expanded.extensions.exception;\n    }\n    return expanded;\n}\nfunction toApolloError(error, code = 'INTERNAL_SERVER_ERROR') {\n    let err = error;\n    if (err.extensions) {\n        err.extensions.code = code;\n    }\n    else {\n        err.extensions = { code };\n    }\n    return err;\n}\nexports.toApolloError = toApolloError;\nfunction fromGraphQLError(error, options) {\n    const copy = options && options.errorClass\n        ? new options.errorClass(error.message)\n        : new ApolloError(error.message);\n    Object.keys(error).forEach(key => {\n        copy[key] = error[key];\n    });\n    copy.extensions = Object.assign(Object.assign({}, copy.extensions), error.extensions);\n    if (!copy.extensions.code) {\n        copy.extensions.code = (options && options.code) || 'INTERNAL_SERVER_ERROR';\n    }\n    Object.defineProperty(copy, 'originalError', { value: {} });\n    Object.getOwnPropertyNames(error).forEach(key => {\n        Object.defineProperty(copy.originalError, key, { value: error[key] });\n    });\n    return copy;\n}\nexports.fromGraphQLError = fromGraphQLError;\nclass SyntaxError extends ApolloError {\n    constructor(message) {\n        super(message, 'GRAPHQL_PARSE_FAILED');\n        Object.defineProperty(this, 'name', { value: 'SyntaxError' });\n    }\n}\nexports.SyntaxError = SyntaxError;\nclass ValidationError extends ApolloError {\n    constructor(message) {\n        super(message, 'GRAPHQL_VALIDATION_FAILED');\n        Object.defineProperty(this, 'name', { value: 'ValidationError' });\n    }\n}\nexports.ValidationError = ValidationError;\nclass AuthenticationError extends ApolloError {\n    constructor(message) {\n        super(message, 'UNAUTHENTICATED');\n        Object.defineProperty(this, 'name', { value: 'AuthenticationError' });\n    }\n}\nexports.AuthenticationError = AuthenticationError;\nclass ForbiddenError extends ApolloError {\n    constructor(message) {\n        super(message, 'FORBIDDEN');\n        Object.defineProperty(this, 'name', { value: 'ForbiddenError' });\n    }\n}\nexports.ForbiddenError = ForbiddenError;\nclass PersistedQueryNotFoundError extends ApolloError {\n    constructor() {\n        super('PersistedQueryNotFound', 'PERSISTED_QUERY_NOT_FOUND');\n        Object.defineProperty(this, 'name', {\n            value: 'PersistedQueryNotFoundError',\n        });\n    }\n}\nexports.PersistedQueryNotFoundError = PersistedQueryNotFoundError;\nclass PersistedQueryNotSupportedError extends ApolloError {\n    constructor() {\n        super('PersistedQueryNotSupported', 'PERSISTED_QUERY_NOT_SUPPORTED');\n        Object.defineProperty(this, 'name', {\n            value: 'PersistedQueryNotSupportedError',\n        });\n    }\n}\nexports.PersistedQueryNotSupportedError = PersistedQueryNotSupportedError;\nclass UserInputError extends ApolloError {\n    constructor(message, properties) {\n        super(message, 'BAD_USER_INPUT', properties);\n        Object.defineProperty(this, 'name', { value: 'UserInputError' });\n    }\n}\nexports.UserInputError = UserInputError;\nfunction formatApolloErrors(errors, options) {\n    if (!options) {\n        return errors.map(error => enrichError(error));\n    }\n    const { formatter, debug } = options;\n    const enrichedErrors = errors.map(error => enrichError(error, debug));\n    const makePrintable = error => {\n        if (error instanceof Error) {\n            const graphQLError = error;\n            return Object.assign(Object.assign(Object.assign({ message: graphQLError.message }, (graphQLError.locations && { locations: graphQLError.locations })), (graphQLError.path && { path: graphQLError.path })), (graphQLError.extensions && { extensions: graphQLError.extensions }));\n        }\n        return error;\n    };\n    if (!formatter) {\n        return enrichedErrors;\n    }\n    return enrichedErrors.map(error => {\n        try {\n            return makePrintable(formatter(error));\n        }\n        catch (err) {\n            if (debug) {\n                return enrichError(err, debug);\n            }\n            else {\n                const newError = fromGraphQLError(new graphql_1.GraphQLError('Internal server error'));\n                return enrichError(newError, debug);\n            }\n        }\n    });\n}\nexports.formatApolloErrors = formatApolloErrors;\nfunction hasPersistedQueryError(errors) {\n    return Array.isArray(errors)\n        ? errors.some(error => error instanceof PersistedQueryNotFoundError ||\n            error instanceof PersistedQueryNotSupportedError)\n        : false;\n}\nexports.hasPersistedQueryError = hasPersistedQueryError;\n//# sourceMappingURL=index.js.map"]},"metadata":{},"sourceType":"script"}