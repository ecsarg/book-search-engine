{"ast":null,"code":"\"use strict\"; // tslint:disable restrict-plus-operands\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst tslib_1 = require(\"tslib\");\n\nconst chalk_1 = (0, tslib_1.__importDefault)(require(\"chalk\"));\nconst supportsColor = (0, tslib_1.__importStar)(require(\"supports-color\"));\nconst deps_1 = (0, tslib_1.__importDefault)(require(\"../deps\"));\n\nconst base_1 = require(\"./base\");\n/* eslint-disable-next-line node/no-missing-require */\n\n\nconst spinners = require('./spinners');\n\nfunction color(s) {\n  if (!supportsColor) return s;\n  const has256 = supportsColor.stdout ? supportsColor.stdout.has256 : (process.env.TERM || '').includes('256');\n  return has256 ? `\\u001B[38;5;104m${s}${deps_1.default.ansiStyles.reset.open}` : chalk_1.default.magenta(s);\n}\n\nclass SpinnerAction extends base_1.ActionBase {\n  constructor() {\n    super();\n    this.type = 'spinner';\n    this.frames = spinners[process.platform === 'win32' ? 'line' : 'dots2'].frames;\n    this.frameIndex = 0;\n  }\n\n  _start() {\n    this._reset();\n\n    if (this.spinner) clearInterval(this.spinner);\n\n    this._render();\n\n    this.spinner = setInterval(icon => this._render.bind(this)(icon), process.platform === 'win32' ? 500 : 100, 'spinner');\n    const interval = this.spinner;\n    interval.unref();\n  }\n\n  _stop(status) {\n    if (this.task) this.task.status = status;\n    if (this.spinner) clearInterval(this.spinner);\n\n    this._render();\n\n    this.output = undefined;\n  }\n\n  _pause(icon) {\n    if (this.spinner) clearInterval(this.spinner);\n\n    this._reset();\n\n    if (icon) this._render(` ${icon}`);\n    this.output = undefined;\n  }\n\n  _frame() {\n    const frame = this.frames[this.frameIndex];\n    this.frameIndex = ++this.frameIndex % this.frames.length;\n    return color(frame);\n  }\n\n  _render(icon) {\n    const task = this.task;\n    if (!task) return;\n\n    this._reset();\n\n    this._flushStdout();\n\n    const frame = icon === 'spinner' ? ` ${this._frame()}` : icon || '';\n    const status = task.status ? ` ${task.status}` : '';\n    this.output = `${task.action}...${frame}${status}\\n`;\n\n    this._write(this.std, this.output);\n  }\n\n  _reset() {\n    if (!this.output) return;\n\n    const lines = this._lines(this.output);\n\n    this._write(this.std, deps_1.default.ansiEscapes.cursorLeft + deps_1.default.ansiEscapes.cursorUp(lines) + deps_1.default.ansiEscapes.eraseDown);\n\n    this.output = undefined;\n  }\n\n  _lines(s) {\n    return deps_1.default.stripAnsi(s).split('\\n').map(l => Math.ceil(l.length / deps_1.default.screen.errtermwidth)).reduce((c, i) => c + i, 0);\n  }\n\n}\n\nexports.default = SpinnerAction;","map":{"version":3,"names":["Object","defineProperty","exports","value","tslib_1","require","chalk_1","__importDefault","supportsColor","__importStar","deps_1","base_1","spinners","color","s","has256","stdout","process","env","TERM","includes","default","ansiStyles","reset","open","magenta","SpinnerAction","ActionBase","constructor","type","frames","platform","frameIndex","_start","_reset","spinner","clearInterval","_render","setInterval","icon","bind","interval","unref","_stop","status","task","output","undefined","_pause","_frame","frame","length","_flushStdout","action","_write","std","lines","_lines","ansiEscapes","cursorLeft","cursorUp","eraseDown","stripAnsi","split","map","l","Math","ceil","screen","errtermwidth","reduce","c","i"],"sources":["/Users/Ellie/Desktop/projects/book-search-engine/client/node_modules/cli-ux/lib/action/spinner.js"],"sourcesContent":["\"use strict\";\n// tslint:disable restrict-plus-operands\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst tslib_1 = require(\"tslib\");\nconst chalk_1 = (0, tslib_1.__importDefault)(require(\"chalk\"));\nconst supportsColor = (0, tslib_1.__importStar)(require(\"supports-color\"));\nconst deps_1 = (0, tslib_1.__importDefault)(require(\"../deps\"));\nconst base_1 = require(\"./base\");\n/* eslint-disable-next-line node/no-missing-require */\nconst spinners = require('./spinners');\nfunction color(s) {\n    if (!supportsColor)\n        return s;\n    const has256 = supportsColor.stdout ? supportsColor.stdout.has256 : (process.env.TERM || '').includes('256');\n    return has256 ? `\\u001B[38;5;104m${s}${deps_1.default.ansiStyles.reset.open}` : chalk_1.default.magenta(s);\n}\nclass SpinnerAction extends base_1.ActionBase {\n    constructor() {\n        super();\n        this.type = 'spinner';\n        this.frames = spinners[process.platform === 'win32' ? 'line' : 'dots2'].frames;\n        this.frameIndex = 0;\n    }\n    _start() {\n        this._reset();\n        if (this.spinner)\n            clearInterval(this.spinner);\n        this._render();\n        this.spinner = setInterval(icon => this._render.bind(this)(icon), process.platform === 'win32' ? 500 : 100, 'spinner');\n        const interval = this.spinner;\n        interval.unref();\n    }\n    _stop(status) {\n        if (this.task)\n            this.task.status = status;\n        if (this.spinner)\n            clearInterval(this.spinner);\n        this._render();\n        this.output = undefined;\n    }\n    _pause(icon) {\n        if (this.spinner)\n            clearInterval(this.spinner);\n        this._reset();\n        if (icon)\n            this._render(` ${icon}`);\n        this.output = undefined;\n    }\n    _frame() {\n        const frame = this.frames[this.frameIndex];\n        this.frameIndex = ++this.frameIndex % this.frames.length;\n        return color(frame);\n    }\n    _render(icon) {\n        const task = this.task;\n        if (!task)\n            return;\n        this._reset();\n        this._flushStdout();\n        const frame = icon === 'spinner' ? ` ${this._frame()}` : icon || '';\n        const status = task.status ? ` ${task.status}` : '';\n        this.output = `${task.action}...${frame}${status}\\n`;\n        this._write(this.std, this.output);\n    }\n    _reset() {\n        if (!this.output)\n            return;\n        const lines = this._lines(this.output);\n        this._write(this.std, deps_1.default.ansiEscapes.cursorLeft + deps_1.default.ansiEscapes.cursorUp(lines) + deps_1.default.ansiEscapes.eraseDown);\n        this.output = undefined;\n    }\n    _lines(s) {\n        return deps_1.default\n            .stripAnsi(s)\n            .split('\\n')\n            .map(l => Math.ceil(l.length / deps_1.default.screen.errtermwidth))\n            .reduce((c, i) => c + i, 0);\n    }\n}\nexports.default = SpinnerAction;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}